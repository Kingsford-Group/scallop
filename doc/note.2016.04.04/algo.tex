\frame
{
	\frametitle{Formulation}

	\begin{itemize}
	\item<1-> {\bf Input:} fully connected directed acyclic graph $G=(V,E)$ with source $s$ and sink $t$,
		and flow vector $f$.
	\end{itemize}

	\vspace{0.8cm}
	\input{figs/graph1.tex}
	\vspace{-0.1cm}

	\begin{displaymath}
	M = \bordermatrix{
		~   & e_1 & e_2 & e_3 & e_4 & e_5 & e_6 & e_7 \cr
		p_1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 \cr
		p_2 & 1 & 1 & 0 & 0 & 0 & 0 & 1 \cr
		p_3 & 1 & 0 & 0 & 1 & 0 & 1 & 0 \cr
		p_4 & 0 & 0 & 1 & 1 & 1 & 0 & 0 \cr
		p_5 & 0 & 0 & 0 & 0 & 1 & 0 & 1 \cr
	}
	\end{displaymath}

	\vspace{0.1cm}

	\begin{itemize}
	\item<1-> {\bf Output:} $P\subset R(M)$ {\bf and} vector $s$
		such that $f = s\cdot P$ and that $|R(P)|$ is minimized.
	\end{itemize}
}

\frame
{
	\frametitle{Facts}
	Let $\Delta = |E| - |V| + 2$. Let $(P^*, s^*)$ be any optimal solution.
	\vspace{0.3cm}
	\begin{itemize}
	\item<1-> {\bf Fact~1:} $rank(M) = \Delta$.
	\vspace{0.3cm}
	\item<1-> {\bf Fact~2:} $rank(P^*) = |R(P^*)|$.
	\vspace{0.3cm}
	\item<1-> {\bf Fact~3:} $|R(P^*)| \le \Delta$.
	\vspace{0.3cm}
	\item<1-> {\bf Fact~4:} If $|R(M)| = \Delta$, then the solution is unique: $(M, s)$, where
		$s$ is determined by $f = s\cdot M$. {\bf [trivial cases]}
	\vspace{0.3cm}
	\item<1-> {\bf Fact~5:} If $|R(P^*)| = \Delta$, then greedy algorithm is guarenteed to give optimal
		solution. {\bf [easy cases]}
	\vspace{0.3cm}
	\item<1-> {\bf Degenerated cases:} $|R(P^*)| < \Delta$. {\bf [hard cases]}
	\end{itemize}
}

\frame
{
	\frametitle{Degeneration Theorem}
	\begin{itemize}
	\item {\bf Theorem:} there exist $k=\Delta - |R(P^*)|$ linearly independent
	{\it non-trivial} vectors $q_1,\cdots,q_k$ satisfying $f\cdot q_i = 0$, $1\le i\le k$.
	\end{itemize}

	\vspace{0.7cm}

	\input{figs/graph2.tex}

	\vspace{-0.4cm}

	\begin{displaymath}
	\bordermatrix{
		~   & e_1 & e_2 & e_3 & e_4 & e_5 & e_6\cr
		p_1 & 1 & 0 & 1 & 0 & 0 & 1 \cr
		p_2 & 1 & 0 & 0 & 1 & 1 & 0 \cr
		p_3 & 0 & 1 & 1 & 0 & 1 & 0 \cr
	} 
	\bordermatrix{
   	   ~& q_1 & q_2 & q_3 \cr
		& +1 &  0 & +1  \cr
		& +1 &  0 &  0  \cr
		& -1 & +1 &  0  \cr
		& -1 & +1 & -1  \cr
		&  0 & -1 &  0  \cr
		&  0 & -1 & -1  \cr
	} = 0
	\end{displaymath}

	\begin{itemize}
	\item Consider the {\bf null space} of $P^*$, i.e., $N(P^*) = \{q | P^*\cdot q = 0\}$.
	\item For any $q\in N(P^*)$, we have $f\cdot q = s\cdot P \cdot q = 0$. 
	\item $\dim(N(P^*)) = |E| - rank(P^*) = |E| - |R(P^*)|$. 
	\end{itemize}
}

\frame
{
	\frametitle{Identifying Equations}
	\begin{itemize}
	\item {\bf Conjecture:} $q_i \in \{+1, -1, 0\}$.
	\vspace{0.2cm}
	\item Only consider two simple forms of equations in the current implementation:
		\begin{align}
		f_i & =  f_{i_1} + f_{i_2} + \cdots + f_{i_k} \tag{a}\\
		f_i + f_j & = f_{i_1} + f_{i_2} + \cdots + f_{i_k} \tag{b}
		\end{align}
	\item {\bf Algorithm:} Use the existing pseudo-polynomial-time algorithm for the subset-sum problem.
	\vspace{0.2cm}
	\item For equation of form (a): split $e_i$ into $k$ edges, each with flow
	value of $f_{i_k}$; record these $k$ pairs of edges with equal flow.
	\vspace{0.2cm}
	\item For equation of form (b): use heuristics to split both sides into
			identical set of edges; record these pairs with equal flow.
	\end{itemize}
}

\frame
{
	\frametitle{Merge Adjacent Edges with Equal Flow}
	\vspace{-2.0cm}

	\begin{itemize}
	\item {\bf Algorithm:} merge them directly.
	\end{itemize}

	\vspace{0.8cm}
	\input{figs/graph3.tex}

}


\frame
{
	\frametitle{Merge Distant Edges with Equal Flow}
	\vspace{-3.0cm}

	\begin{itemize}
	\item {\bf Algorithm:} {\bf inverse} and {\bf swap} subgraphs based on the its (partial) {\bf nested} structure.
	\end{itemize}

	\vspace{0.8cm}
	\input{figs/graph4.tex}

}

\frame
{
	\frametitle{Algorithm}
	\begin{itemize}
	\item[1.] Iterate until no change is made to the splice graph. {\bf [core]}
		\vspace{0.2cm}
		\begin{itemize}
		\item[a.] Decompose trivial vertices
		\vspace{0.2cm}
		\item[b.] Identify type~(a) equation and split it
		\vspace{0.2cm}
		\item[c.] Merge equal edges that can be made adjacent
		\vspace{0.2cm}
		\item[d.] Merge equal edges that can not be made adjacent~(*)
		\vspace{0.2cm}
		\item[e.] Identify type~(b) equation and split it~(*)
		\vspace{0.2cm}
		\end{itemize}
	\item[2.] Arbitrarily decompose the remaining graph using greedy
		algorithm~(but optimal solution is not unique).

	\vspace{0.2cm}
	\item[0.] For cases that the estimated flow value are not perfect, 
		we can use LP to correct them when identify equations.
	\end{itemize}
}

\frame
{
	\frametitle{Simulation Results}

	\begin{itemize}
	\item Use iGenome annotation~(gtf file) of Human genome.
	\item Use Flux Simulator to only simulate expression.
	\item Average over 100 independent 100 instances.
	\end{itemize}

	\vspace{0.2cm}
	\def\SA{\hspace*{0pt}}
	\def\SC{\hspace*{-2pt}}
	\def\SB{\hspace*{1pt}}
	\def\SD{\hspace*{3pt}}

	\begin{table}
	\begin{center}%
		\setlength{\tabcolsep}{6.47pt}%
		\begin{tabular}{rrrrrrrrrrrrrrrrrrrrrrrrrrr}%
		\hline
		     & genes & trivial & easy & hard & greedy & scallop \\
		\hline
		average & 11374 & 8203 & 129 & 3036 & 99.3 & {\bf 7.8} \\
		\hline
		ratio(\%)  & 100 & 72.2  & 1.1 & 26.7 & 3.3 & {\bf 0.26} \\
		\hline
		\end{tabular}%
	\end{center}%
	\caption{Capability of returning minimized number of paths.}
	\end{table}

	\vspace{-0.2cm}
	\begin{table}
	\begin{center}%
		\setlength{\tabcolsep}{2.8pt}%
		\begin{tabular}{rrrrrrrrrrrrrrrrrrrrrrrrrrr}%
		\hline
		\multirow{2}{*}{algorithm} &\SB& \multicolumn{3}{c}{gene-level} &\SD& \multicolumn{3}{c}{transcript-level}\\
		\cline{3-5} \cline{7-9}
		     && correct & predicted & ratio && correct & predicted & ratio\\
		\hline
		core    && 2623 & 2725 & 95.6 && 6763 & 7029 & {\bf 96.2} \\
		scallop && 2683 & 3035 & 88.4 && 7608 & 8924 & 85.2 \\
		greedy  && 2617 & 3035 & 86.2 && 7304 & 9037 & 80.8 \\
		\hline
		\end{tabular}%
	\end{center}%
	\caption{Accuracy of predicted transcripts.}
	\end{table}

}

\frame
{
	\frametitle{Next Steps}

	\begin{itemize}
	\item Prove/disprove the conjecture.
	\vspace{0.2cm}
	\item Design better algorithms to use type (b) and even more complicated equations.
	\vspace{0.2cm}
	\item Work on generating high quality splice graph~(identify exons and estimate
			flow values) from sequence data.
	\vspace{0.2cm}
	\item Think about applying this algorithm to othe problems, for example, to
		help the EM-step of the quantification algorithm.
	\end{itemize}
}
